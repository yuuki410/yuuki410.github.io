---
title: apt连接失败 - 解决方法
date: 2022-01-31 22:25:49
categories:
- guide
tags:
- apt
---

## 问题

有时候会遇到一些让人火冒三丈的情况：
<details>
```bash
$ sudo apt install com.qq.im.deepin -y
正在读取软件包列表... 完成
正在分析软件包的依赖关系树       
正在读取状态信息... 完成
将会同时安装下列软件：
  deepin-wine6-stable deepin-wine6-stable-amd64 deepin-wine6-stable-i386:i386
  fonts-wqy-microhei fonts-wqy-zenhei libatk-bridge2.0-0:i386 libatk1.0-0:i386
  libatspi2.0-0:i386 libcolord2:i386 libepoxy0:i386 libgtk-3-0:i386
  libjson-glib-1.0-0:i386 librest-0.7-0:i386 libsoup-gnome2.4-1:i386
建议安装：
  gvfs:i386
下列【新】软件包将被安装：
  com.qq.im.deepin:i386 deepin-wine6-stable deepin-wine6-stable-amd64
  deepin-wine6-stable-i386:i386 fonts-wqy-microhei fonts-wqy-zenhei
  libatk-bridge2.0-0:i386 libatk1.0-0:i386 libatspi2.0-0:i386 libcolord2:i386
  libepoxy0:i386 libgtk-3-0:i386 libjson-glib-1.0-0:i386 librest-0.7-0:i386
  libsoup-gnome2.4-1:i386
升级了 0 个软件包，新安装了 15 个软件包，要卸载 0 个软件包，有 0 个软件包未被升级。
需要下载 9,075 kB/194 MB 的归档。
解压缩后会消耗 668 MB 的额外空间。
忽略:1 http://archive.ubuntu.com/ubuntu focal/universe amd64 fonts-wqy-zenhei all 0.9.45-7ubuntu1
忽略:2 http://archive.ubuntu.com/ubuntu focal/universe amd64 fonts-wqy-microhei all 0.2.0-beta-3
错误:1 http://archive.ubuntu.com/ubuntu focal/universe amd64 fonts-wqy-zenhei all 0.9.45-7ubuntu1
  连接失败 [IP: 91.189.88.152 80]
错误:2 http://archive.ubuntu.com/ubuntu focal/universe amd64 fonts-wqy-microhei all 0.2.0-beta-3
  连接失败 [IP: 91.189.88.152 80]
E: 无法下载 http://archive.ubuntu.com/ubuntu/pool/universe/f/fonts-wqy-zenhei/fonts-wqy-zenhei_0.9.45-7ubuntu1_all.deb  连接失败 [IP: 91.189.88.152 80]
E: 无法下载 http://archive.ubuntu.com/ubuntu/pool/universe/f/fonts-wqy-microhei/fonts-wqy-microhei_0.2.0-beta-3_all.deb  连接失败 [IP: 91.189.88.152 80]
E: 有几个软件包无法下载，要不运行 apt-get update 或者加上 --fix-missing 的选项再试试？
```
</details>

试过apt提示的方法却无效……仍然显示相同的错误。

## 解决

经查，可以手动下载失败的包，然后把文件移动到`/var/cache/apt/archives`就能被apt找到了（别问为什么会出现上述问题，问就是没文化）。

<!--more -->

我运行的命令是：
```bash
cd /var/cache/apt/archives
wget http://archive.ubuntu.com/ubuntu/pool/universe/f/fonts-wqy-zenhei/fonts-wqy-zenhei_0.9.45-7ubuntu1_all.deb
http://archive.ubuntu.com/ubuntu/pool/universe/f/fonts-wqy-microhei/fonts-wqy-microhei_0.2.0-beta-3_all.deb
```

好，现在可以舒服地安装了！
<details>
<summray>命令及输出</summray>
```bash
$ sudo apt install com.qq.im.deepin -y
正在读取软件包列表... 完成
正在分析软件包的依赖关系树       
正在读取状态信息... 完成
将会同时安装下列软件：
  deepin-wine6-stable deepin-wine6-stable-amd64 deepin-wine6-stable-i386:i386
  fonts-wqy-microhei fonts-wqy-zenhei libatk-bridge2.0-0:i386 libatk1.0-0:i386
  libatspi2.0-0:i386 libcolord2:i386 libepoxy0:i386 libgtk-3-0:i386
  libjson-glib-1.0-0:i386 librest-0.7-0:i386 libsoup-gnome2.4-1:i386
建议安装：
  gvfs:i386
下列【新】软件包将被安装：
  com.qq.im.deepin:i386 deepin-wine6-stable deepin-wine6-stable-amd64
  deepin-wine6-stable-i386:i386 fonts-wqy-microhei fonts-wqy-zenhei
  libatk-bridge2.0-0:i386 libatk1.0-0:i386 libatspi2.0-0:i386 libcolord2:i386
  libepoxy0:i386 libgtk-3-0:i386 libjson-glib-1.0-0:i386 librest-0.7-0:i386
  libsoup-gnome2.4-1:i386
升级了 0 个软件包，新安装了 15 个软件包，要卸载 0 个软件包，有 0 个软件包未被升级。
需要下载 0 B/194 MB 的归档。
解压缩后会消耗 668 MB 的额外空间。
正在选中未选择的软件包 libatk1.0-0:i386。
(正在读取数据库 ... 系统当前共安装有 280330 个文件和目录。)
准备解压 .../00-libatk1.0-0_2.35.1-1ubuntu2_i386.deb  ...
正在解压 libatk1.0-0:i386 (2.35.1-1ubuntu2) ...
正在选中未选择的软件包 libatspi2.0-0:i386。
准备解压 .../01-libatspi2.0-0_2.36.0-2_i386.deb  ...
正在解压 libatspi2.0-0:i386 (2.36.0-2) ...
正在选中未选择的软件包 libatk-bridge2.0-0:i386。
准备解压 .../02-libatk-bridge2.0-0_2.34.2-0ubuntu2~20.04.1_i386.deb  ...
正在解压 libatk-bridge2.0-0:i386 (2.34.2-0ubuntu2~20.04.1) ...
正在选中未选择的软件包 libcolord2:i386。
准备解压 .../03-libcolord2_1.4.4-2_i386.deb  ...
正在解压 libcolord2:i386 (1.4.4-2) ...
正在选中未选择的软件包 libepoxy0:i386。
准备解压 .../04-libepoxy0_1.5.4-1_i386.deb  ...
正在解压 libepoxy0:i386 (1.5.4-1) ...
正在选中未选择的软件包 libjson-glib-1.0-0:i386。
准备解压 .../05-libjson-glib-1.0-0_1.4.4-2ubuntu2_i386.deb  ...
正在解压 libjson-glib-1.0-0:i386 (1.4.4-2ubuntu2) ...
正在选中未选择的软件包 libsoup-gnome2.4-1:i386。
准备解压 .../06-libsoup-gnome2.4-1_2.70.0-1_i386.deb  ...
正在解压 libsoup-gnome2.4-1:i386 (2.70.0-1) ...
正在选中未选择的软件包 librest-0.7-0:i386。
准备解压 .../07-librest-0.7-0_0.8.1-1_i386.deb  ...
正在解压 librest-0.7-0:i386 (0.8.1-1) ...
正在选中未选择的软件包 libgtk-3-0:i386。
准备解压 .../08-libgtk-3-0_3.24.20-0ubuntu1_i386.deb  ...
正在解压 libgtk-3-0:i386 (3.24.20-0ubuntu1) ...
正在选中未选择的软件包 deepin-wine6-stable-i386:i386。
准备解压 .../09-deepin-wine6-stable-i386_6.0.0.19-1_i386.deb  ...
正在解压 deepin-wine6-stable-i386:i386 (6.0.0.19-1) ...
正在选中未选择的软件包 deepin-wine6-stable-amd64。
准备解压 .../10-deepin-wine6-stable-amd64_6.0.0.19-1_amd64.deb  ...
正在解压 deepin-wine6-stable-amd64 (6.0.0.19-1) ...
正在选中未选择的软件包 deepin-wine6-stable。
准备解压 .../11-deepin-wine6-stable_6.0.0.19-1_amd64.deb  ...
正在解压 deepin-wine6-stable (6.0.0.19-1) ...
正在选中未选择的软件包 fonts-wqy-zenhei。
准备解压 .../12-fonts-wqy-zenhei_0.9.45-7ubuntu1_all.deb  ...
正在解压 fonts-wqy-zenhei (0.9.45-7ubuntu1) ...
正在选中未选择的软件包 fonts-wqy-microhei。
准备解压 .../13-fonts-wqy-microhei_0.2.0-beta-3_all.deb  ...
正在解压 fonts-wqy-microhei (0.2.0-beta-3) ...
正在选中未选择的软件包 com.qq.im.deepin:i386。
准备解压 .../14-com.qq.im.deepin_9.4.9.27849deepin5_i386.deb  ...
正在解压 com.qq.im.deepin:i386 (9.4.9.27849deepin5) ...
正在设置 deepin-wine6-stable-amd64 (6.0.0.19-1) ...
正在设置 fonts-wqy-zenhei (0.9.45-7ubuntu1) ...
正在设置 libatspi2.0-0:i386 (2.36.0-2) ...
正在设置 libcolord2:i386 (1.4.4-2) ...
正在设置 fonts-wqy-microhei (0.2.0-beta-3) ...
正在设置 libjson-glib-1.0-0:i386 (1.4.4-2ubuntu2) ...
正在设置 libepoxy0:i386 (1.5.4-1) ...
正在设置 libatk1.0-0:i386 (2.35.1-1ubuntu2) ...
正在设置 libsoup-gnome2.4-1:i386 (2.70.0-1) ...
正在设置 librest-0.7-0:i386 (0.8.1-1) ...
正在设置 libatk-bridge2.0-0:i386 (2.34.2-0ubuntu2~20.04.1) ...
正在设置 libgtk-3-0:i386 (3.24.20-0ubuntu1) ...
正在设置 deepin-wine6-stable-i386:i386 (6.0.0.19-1) ...
正在设置 deepin-wine6-stable (6.0.0.19-1) ...
正在设置 com.qq.im.deepin:i386 (9.4.9.27849deepin5) ...
正在处理用于 libc-bin (2.31-0ubuntu9.2) 的触发器 ...
正在处理用于 fontconfig (2.13.1-2ubuntu3) 的触发器 ...
```
</details>

## 另外

有时候会遇到一个软件包移动到他处的情况，这时候只能花点时间更换一些旧源或者手动下载新的包然后改名在存到apt缓存目录下了。